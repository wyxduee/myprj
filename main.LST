C51 COMPILER V9.51   MAIN                                                                  05/07/2018 11:22:45 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          
   2          #include<AT89x51.H>
   3          #include "stdio.h"
   4          
   5          
   6          unsigned char receive_buff[50]=0;
   7          
   8          
   9          void delay(unsigned int x){
  10   1        unsigned char i;
  11   1        while(x--){
  12   2          for(i=0;i<120;i++);
  13   2        }
  14   1      }
  15          
  16          
  17          void send_char (unsigned char c){
  18   1        SBUF=c;
  19   1        while(TI==0);
  20   1        TI=0;
  21   1      }
  22          
  23          void send_str(unsigned char *s){
  24   1        while(*s != '\0'){
  25   2          send_char(*s);
  26   2          s++;
  27   2          delay(5);
  28   2        }
  29   1      }
  30          
  31          void PutString(unsigned char *TXStr)  
  32          {                
  33   1          ES=0;     
  34   1           while(*TXStr!=0) 
  35   1          {                      
  36   2              SBUF=*TXStr;
  37   2              while(TI==0);
  38   2              TI=0;    
  39   2              TXStr++;
  40   2          }
  41   1          ES=1; 
  42   1      }  
  43          unsigned char * RecStr;
  44          unsigned char count;  
  45          unsigned char num=0;
  46          //
  47          bit ReceiveString()    
  48          {
  49   1          RecStr=receive_buff;
  50   1          num=0;
  51   1          loop:    
  52   1          *RecStr=SBUF;
  53   1          count=0;
  54   1          RI=0;    
  55   1          //if(num<10)  //
C51 COMPILER V9.51   MAIN                                                                  05/07/2018 11:22:45 PAGE 2   

  56   1          //{
  57   1             // num++;
  58   1              RecStr++;    
  59   1              while(!RI)
  60   1              {
  61   2                  count++;
  62   2                  if(count>130)
  63   2                  {
  64   3                    *RecStr='\0';
  65   3                  //  RI=0;
  66   3                    return 0;
  67   3                  }    //
  68   2              }
  69   1              goto loop;
  70   1          //}
  71   1          *RecStr='\0';
  72   1        //  RI=0;
  73   1          
  74   1          return 1;
  75   1      }
  76          
  77          
  78          
  79          
  80          
  81          
  82          void sint() interrupt 4
  83          {
  84   1          if(ReceiveString())    
  85   1          {
  86   2              send_str(receive_buff);   
  87   2          }
  88   1          else 
  89   1          {
  90   2              send_str(receive_buff);   
  91   2          }
  92   1      
  93   1          RI=0;  //
  94   1      
  95   1          
  96   1      }
  97          
  98          
  99          /*********************************************************************/   
 100          
 101          
 102            void main(void)
 103          {
 104   1          TMOD=0x20;  
 105   1          TH1=0xFd;        //11.0592M¾§Õñ£¬9600²¨ÌØÂÊ
 106   1          TL1=0xFd;
 107   1          SCON=0x50;  
 108   1          //TMOD &=~0x10;
 109   1          PCON=0x00;
 110   1          //PCON |=0x80;
 111   1          TR1=1;
 112   1          ES=1;  
 113   1          TI=0;
 114   1          RI=0;
 115   1          EA=1;   
 116   1        
 117   1          while(1){
C51 COMPILER V9.51   MAIN                                                                  05/07/2018 11:22:45 PAGE 3   

 118   2          
 119   2          }
 120   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    245    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     55       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
